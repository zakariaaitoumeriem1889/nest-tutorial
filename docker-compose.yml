services:
    database:
        container_name: database
        image: postgres:alpine
        ports:
            - "5432:5432"
        environment:
            POSTGRES_USER: nest
            POSTGRES_PASSWORD: nest
            POSTGRES_DB: app
            POSTGRES_INITDB_ARGS: "--encoding=UTF8 --locale=C.UTF-8"
        command:
            - "postgres"
            - "-c"
            - "client_encoding=UTF8"
            - "-c"
            - "timezone=UTC"
        healthcheck:
            test: ["CMD-SHELL", "pg_isready -U myuser -d mydb"]
            interval: 10s
            timeout: 5s
            retries: 5
        volumes:
            - db-data:/var/lib/postgresql/data
        networks:
            - default
    adminer:
        container_name: adminer
        image: adminer:latest
        ports:
            - "8085:8080"
        depends_on:
            - database
        environment:
            ADMINER_DEFAULT_SERVER: database
            ADMINER_DESIGN: hover
        networks:
            - default

volumes:
    db-data:
        driver: local

networks:
    default:
        driver: bridge
